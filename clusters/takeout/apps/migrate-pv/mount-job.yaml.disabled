apiVersion: batch/v1
kind: Job
metadata:
  name: mount-pv
  namespace: default
spec:
  template:
    spec:
      containers:
      - name: migrate-pv
        image: debian
        command: [ "/bin/bash", "-c" ]
        args:
          - tail -f /dev/null
        #   -
        #     apt-get update && apt-get install -y rsync &&
        #     ls -lah /src_vol /dst_vol &&
        #     df -h &&
        #     rsync -av --info=progress2 --delete /src_vol/ /dst_vol/ &&
        #     ls -lah /dst_vol/ &&
        #     du -shxc /src_vol/ /dst_vol/
        volumeMounts:
        - mountPath: /src_vol
          name: src
          readOnly: true
        - mountPath: /dst_vol
          name: dst
      restartPolicy: Never
      nodeSelector:
        kubernetes.io/hostname: cameraman
      volumes:
      - name: src
        persistentVolumeClaim:
          claimName: stash-temp-previews
      - name: dst
        persistentVolumeClaim:
          claimName: stash-temp-previews-iscsi
  backoffLimit: 0