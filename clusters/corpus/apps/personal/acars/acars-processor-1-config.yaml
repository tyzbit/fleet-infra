# yaml-language-server: $schema=https://raw.githubusercontent.com/tyzbit/acars-processor/refs/heads/main/schema.json

ACARSProcessorSettings:
  ColorOutput: true
  LogLevel: debug
  LogHideTimestamps: true
  Database:
    Enabled: true
    ConnectionString: "${acars_proc_2_db_dsn}"
    Type: mariadb
  ACARSHub:
    MaxConcurrentRequests: 1
    ACARS:
      Host: &acarshubhost acars-acarshub
      Port: 15550
    VDLM2:
      Host: *acarshubhost
      Port: 15555

Steps:
  # Add geolocation if my local ADS-B receiver has information for the aircraft
  - Annotate:
      Tar1090:
        URL: http://adsb-ultrafeeder
        ReferenceGeolocation: "${my_latitude},${my_longitude}"

  # Used for overall metrics and improving filters
  - Send:
      NewRelic:
        APIKey: "${new_relic_license_key}"
        CustomEventType: CustomACARS

  - Filter: { Builtin: { HasText: true } }

  # The decoders often submit duplicate messages as they're able to reassemble
  # the messages
  - Filter:
      Builtin:
        PreviousMessageSimilarity:
          Similarity: 0.90
          MaximumLookBehind: 1000
          DontFilterIfLonger: false # This means I'll see the shortest version of a message, which I prefer over noise.

  # These labels have not had a human-written message in the last 30 days
  - Filter:
      Builtin:
        Invert: true
        Labels:
          - "_d"
          - ""
          - ":;"
          - "12"
          - "16"
          - "21"
          - "22"
          - "32"
          - "33"
          - "36"
          - "3M"
          - "43" # PAX REOPENED
          - "44"
          - "4N"
          - "5V"
          - "8X"
          - "A9"
          - "B9"
          - "BA"
          - "C1"
          - "H1"
          - "HX"
          - "Q0"
          - "SA"
          - "SQ"

  # # These labels have had human-written messages in the last 30 days
  # - Filter:
  #     Builtin:
  #       Labels:
  #         # - "10"
  #         # - "2A"
  #         # - "1D"
  #         # - "30"
  #         # Low concentration of human messages below
  #         - "11"
  #         - "3F"
  #         - "RA" # Tower, mostly routine messages
  #         - "5Z"
  #         - "1A"
  #         - "40" # LOTS of routine tower messages
  #         - "14" # Lots of "Good morning" and wheelchair requests
  #         - "20" # Low concentration, VDL2 judging by lowercase text
  #         - "80"
  #         - "1L" # Diluted with encrypted messages and data reports
  #         - "37"
  #         # Might be filterable
  #         - "34" # 1 PAX FROM CAB E TO CAB A 61B4
  #         - "39" # Less than 1% human messages
  #         - "83" # 0.7% human
  #         - "15" # 0.4% human
  #         - "10" # 0.4% human
  #         # New labels being evaluated
  #         - "17"
  #         - "18"
  #         - "30"
  #         - "3E"
  #         - "45"
  #         - "4C"
  #         - "4P"
  #         - "4T"
  #         - "8"
  #         - "84"
  #         - "25" # Polluted by uninteresting tower messages
  #         - "87"
  #         - "85"
  #         - "81"
  #         - "4R"
  #         - "41" # Polluted by uninteresting tower messages
  #         # Suggest filtering
  #         - "H1" # 0.002% human (human messages were validated)

  # These terms are present in routine messages that can be filtered
  - Filter:
      Builtin:
        Invert: true
        RequireTerms:
          Count: 1
          Terms:
            - /FTMLDR
            - /ACKFLT
            - KO/
            - RESREQ
            - POSRPT
            - AUTOMATED FLT OPS
            - UNFCTRD
            - USADCXA
            - "#DFREQ"
            - ET EXP TIME
            - OFF EVENT
            - EXTEND/UP
            - EXTEND/DOWN
            - RETRACT/UP
            - RETRACT/DOWN
            - /ACARG
            - /EV START
            - /EV STOP
            - LIF RUNWAY REQUEST
            - IF ERRORS ABOVE
            - AGFSR
            - PRG/
            - LOAD CLOSEOUT RVSN
            - ON-TIME ANALYSIS
            - APU START <
            - "<"
            - ">"
            - +++
            - TAKEOFF_
            - OUTRPT
            - .CSV
            - "LOC:"
            - TO 1)
            - "[  ]"
            - ((
            - ))
            - PDC
            - YOW FROM
            - PART 01
            - QUATLASAV
            - /MPTO
            - " /ALT"
            - 0,0,0
            - "(,"
            - ":  "
            - ---- G
            - ------------
            - ---- ---- ---- ----
            - /  /  /
            - "*** REMINDER MESSAGE ***"
            - AUTO CLOSEOUT
            - "EMAIL FROM:"
            # Airport DISP messages
            - ATIS INFO
            - TAXI AND SHUTDOWN THE APU
            - YOUR HELP IS APPRECIATED.
            - ADVS YOU
            - YOU HAVE INFO
            - BIRDS IN THE VICINITY
            - BIRD ACTIVITY
            - READBACK ALL
            - NOTICE TO AIRMEN
            - ALL GATES UNDER
            - S-E TAXI
            - NEXT FLT SUBJECT
            - NEW MRD IS REQUIRED
            - SEND AN OPS CONTROL
            - FLIGHT OPS AUTOMATED MESSAGE
            - DATA USED TO DETERMINE MESSAGE
            - NO ENTRIES IN PECT
            - FORMAT FAILED REPORT
            - RECEIVED FOR OVER 60 MINUTES
            - "LANDING PILOT:"
            - CONFIRM THE BELOW SOULS
            - ALL RWYS AND TWYS
            ###################
            - CODE BLEED STATUS
            - PREFLIGHT BRIEF
            - MDC REPORT
            - EXCEEDANCE REPORT
            - SNAPSHOT REPORT
            - SYSTEM PARAMETERS
            - ENGINE TREND
            - "CAROUSEL:"
            - FILENAME
            - CREW CONNECTING GATE INFO
            - MUST LAND ON RWY
            - REQUEST GATE ASSIGNMENT ETA
            - Equation ID
            - HOWGOZIT
            - RAMP FREQ

  - Filter:
      Builtin:
        RequireTerms:
          Count: 3
          Terms:
            - "ABILITY"
            - "ABLE"
            - "ABOUT"
            - "ABOVE"
            - "ACCEPT"
            - "ACCORDING"
            - "ACCOUNT"
            - "ACROSS"
            - "ACT"
            - "ACTION"
            - "ACTIVITY"
            - "ACTUALLY"
            - "ADD"
            - "ADDRESS"
            - "ADMINISTRATION"
            - "ADMIT"
            - "ADULT"
            - "AFFECT"
            - "AFTER"
            - "AGAIN"
            - "AGAINST"
            - "AGE"
            - "AGENCY"
            - "AGENT"
            - "AGO"
            - "AGREE"
            - "AGREEMENT"
            - "AHEAD"
            - "AIR"
            - "ALL"
            - "ALLOW"
            - "ALMOST"
            - "ALONE"
            - "ALONG"
            - "ALREADY"
            - "ALSO"
            - "ALTHOUGH"
            - "ALWAYS"
            - "AMERICAN"
            - "AMONG"
            - "AMOUNT"
            - "ANALYSIS"
            - "AND"
            - "ANIMAL"
            - "ANOTHER"
            - "ANSWER"
            - "ANY"
            - "ANYONE"
            - "ANYTHING"
            - "APPEAR"
            - "APPLY"
            - "APPROACH"
            - "AREA"
            - "ARGUE"
            - "ARM"
            - "AROUND"
            - "ARRIVE"
            - "ART"
            - "ARTICLE"
            - "ARTIST"
            - "ASK"
            - "ASSUME"
            - "ATTACK"
            - "ATTENTION"
            - "ATTORNEY"
            - "AUDIENCE"
            - "AUTHOR"
            - "AUTHORITY"
            - "AVAILABLE"
            - "AVOID"
            - "AWAY"
            - "BABY"
            - "BACK"
            - "BAD"
            - "BAG"
            - "BALL"
            - "BANK"
            - "BAR"
            - "BASE"
            - "BEAT"
            - "BEAUTIFUL"
            - "BECAUSE"
            - "BECOME"
            - "BED"
            - "BEFORE"
            - "BEGIN"
            - "BEHAVIOR"
            - "BEHIND"
            - "BELIEVE"
            - "BENEFIT"
            - "BEST"
            - "BETTER"
            - "BETWEEN"
            - "BEYOND"
            - "BIG"
            - "BILL"
            - "BILLION"
            - "BIT"
            - "BLACK"
            - "BLOOD"
            - "BLUE"
            - "BOARD"
            - "BODY"
            - "BOOK"
            - "BORN"
            - "BOTH"
            - "BOX"
            - "BOY"
            - "BREAK"
            - "BRING"
            - "BROTHER"
            - "BUDGET"
            - "BUILD"
            - "BUILDING"
            - "BUSINESS"
            - "BUT"
            - "BUY"
            - "CALL"
            - "CAMERA"
            - "CAMPAIGN"
            - "CAN"
            - "CANCER"
            - "CANDIDATE"
            - "CAPITAL"
            - "CAR"
            - "CARD"
            - "CARE"
            - "CAREER"
            - "CARRY"
            - "CASE"
            - "CATCH"
            - "CAUSE"
            - "CELL"
            - "CENTER"
            - "CENTRAL"
            - "CENTURY"
            - "CERTAIN"
            - "CERTAINLY"
            - "CHAIR"
            - "CHALLENGE"
            - "CHANCE"
            - "CHANGE"
            - "CHARACTER"
            - "CHARGE"
            - "CHECK"
            - "CHILD"
            - "CHOICE"
            - "CHOOSE"
            - "CHURCH"
            - "CITIZEN"
            - "CITY"
            - "CIVIL"
            - "CLAIM"
            - "CLASS"
            - "CLEAR"
            - "CLEARLY"
            - "CLOSE"
            - "COACH"
            - "COLD"
            - "COLLECTION"
            - "COLLEGE"
            - "COLOR"
            - "COME"
            - "COMMERCIAL"
            - "COMMON"
            - "COMMUNITY"
            - "COMPANY"
            - "COMPARE"
            - "COMPUTER"
            - "CONCERN"
            - "CONDITION"
            - "CONFERENCE"
            - "CONGRESS"
            - "CONSIDER"
            - "CONSUMER"
            - "CONTAIN"
            - "CONTINUE"
            - "CONTROL"
            - "COST"
            - "COULD"
            - "COUNTRY"
            - "COUPLE"
            - "COURSE"
            - "COURT"
            - "COVER"
            - "CREATE"
            - "CRIME"
            - "CULTURAL"
            - "CULTURE"
            - "CUP"
            - "CURRENT"
            - "CUSTOMER"
            - "CUT"
            - "DARK"
            - "DATA"
            - "DAUGHTER"
            - "DAY"
            - "DEAD"
            - "DEAL"
            - "DEATH"
            - "DEBATE"
            - "DECADE"
            - "DECIDE"
            - "DECISION"
            - "DEEP"
            - "DEFENSE"
            - "DEGREE"
            - "DEMOCRAT"
            - "DEMOCRATIC"
            - "DESCRIBE"
            - "DESIGN"
            - "DESPITE"
            - "DETAIL"
            - "DETERMINE"
            - "DEVELOP"
            - "DEVELOPMENT"
            - "DIE"
            - "DIFFERENCE"
            - "DIFFERENT"
            - "DIFFICULT"
            - "DINNER"
            - "DIRECTION"
            - "DIRECTOR"
            - "DISCOVER"
            - "DISCUSS"
            - "DISCUSSION"
            - "DISEASE"
            - "DOCTOR"
            - "DOG"
            - "DOOR"
            - "DOWN"
            - "DRAW"
            - "DREAM"
            - "DRIVE"
            - "DROP"
            - "DRUG"
            - "DURING"
            - "EACH"
            - "EARLY"
            - "EAST"
            - "EASY"
            - "EAT"
            - "ECONOMIC"
            - "ECONOMY"
            - "EDGE"
            - "EDUCATION"
            - "EFFECT"
            - "EFFORT"
            - "EIGHT"
            - "EITHER"
            - "ELECTION"
            - "ELSE"
            - "EMPLOYEE"
            - "END"
            - "ENERGY"
            - "ENJOY"
            - "ENOUGH"
            - "ENTER"
            - "ENTIRE"
            - "ENVIRONMENT"
            - "ENVIRONMENTAL"
            - "ESPECIALLY"
            - "ESTABLISH"
            - "EVEN"
            - "EVENING"
            - "EVENT"
            - "EVER"
            - "EVERY"
            - "EVERYBODY"
            - "EVERYONE"
            - "EVERYTHING"
            - "EVIDENCE"
            - "EXACTLY"
            - "EXAMPLE"
            - "EXECUTIVE"
            - "EXIST"
            - "EXPECT"
            - "EXPERIENCE"
            - "EXPERT"
            - "EXPLAIN"
            - "EYE"
            - "FACE"
            - "FACT"
            - "FACTOR"
            - "FAIL"
            - "FALL"
            - "FAMILY"
            - "FAR"
            - "FAST"
            - "FATHER"
            - "FEAR"
            - "FEDERAL"
            - "FEEL"
            - "FEELING"
            - "FEW"
            - "FIELD"
            - "FIGHT"
            - "FIGURE"
            - "FILL"
            - "FILM"
            - "FINAL"
            - "FINALLY"
            - "FINANCIAL"
            - "FIND"
            - "FINE"
            - "FINGER"
            - "FINISH"
            - "FIRE"
            - "FIRM"
            - "FIRST"
            - "FISH"
            - "FIVE"
            - "FLOOR"
            - "FLY"
            - "FOCUS"
            - "FOLLOW"
            - "FOOD"
            - "FOOT"
            - "FOR"
            - "FORCE"
            - "FOREIGN"
            - "FORGET"
            - "FORM"
            - "FORMER"
            - "FORWARD"
            - "FOUR"
            - "FREE"
            - "FRIEND"
            - "FROM"
            - "FRONT"
            - "FULL"
            - "FUND"
            - "FUTURE"
            - "GAME"
            - "GARDEN"
            - "GAS"
            - "GENERAL"
            - "GENERATION"
            - "GET"
            - "GIRL"
            - "GIVE"
            - "GLASS"
            - "GOAL"
            - "GOOD"
            - "GOVERNMENT"
            - "GREAT"
            - "GREEN"
            - "GROUND"
            - "GROUP"
            - "GROW"
            - "GROWTH"
            - "GUESS"
            - "GUN"
            - "GUY"
            - "HAIR"
            - "HALF"
            - "HAND"
            - "HANG"
            - "HAPPEN"
            - "HAPPY"
            - "HARD"
            - "HAVE"
            - "HEAD"
            - "HEALTH"
            - "HEAR"
            - "HEART"
            - "HEAT"
            - "HEAVY"
            - "HELP"
            - "HER"
            - "HERE"
            - "HERSELF"
            - "HIGH"
            - "HIM"
            - "HIMSELF"
            - "HIS"
            - "HISTORY"
            - "HIT"
            - "HOLD"
            - "HOME"
            - "HOPE"
            - "HOSPITAL"
            - "HOT"
            - "HOTEL"
            - "HOUR"
            - "HOUSE"
            - "HOW"
            - "HOWEVER"
            - "HUGE"
            - "HUMAN"
            - "HUNDRED"
            - "HUSBAND"
            - "IDEA"
            - "IDENTIFY"
            - "IMAGE"
            - "IMAGINE"
            - "IMPACT"
            - "IMPORTANT"
            - "IMPROVE"
            - "INCLUDE"
            - "INCLUDING"
            - "INCREASE"
            - "INDEED"
            - "INDICATE"
            - "INDIVIDUAL"
            - "INDUSTRY"
            - "INFORMATION"
            - "INSIDE"
            - "INSTEAD"
            - "INSTITUTION"
            - "INTEREST"
            - "INTERESTING"
            - "INTERNATIONAL"
            - "INTERVIEW"
            - "INTO"
            - "INVESTMENT"
            - "INVOLVE"
            - "ISSUE"
            - "ITEM"
            - "ITS"
            - "ITSELF"
            - "JOB"
            - "JOIN"
            - "JUST"
            - "KEEP"
            - "KEY"
            - "KID"
            - "KILL"
            - "KIND"
            - "KITCHEN"
            - "KNOW"
            - "KNOWLEDGE"
            - "LAND"
            - "LANGUAGE"
            - "LARGE"
            - "LAST"
            - "LATE"
            - "LATER"
            - "LAUGH"
            - "LAW"
            - "LAWYER"
            - "LAY"
            - "LEAD"
            - "LEADER"
            - "LEARN"
            - "LEAST"
            - "LEAVE"
            - "LEFT"
            - "LEG"
            - "LEGAL"
            - "LESS"
            - "LET"
            - "LETTER"
            - "LEVEL"
            - "LIE"
            - "LIFE"
            - "LIGHT"
            - "LIKE"
            - "LIKELY"
            - "LINE"
            - "LIST"
            - "LISTEN"
            - "LITTLE"
            - "LIVE"
            - "LOCAL"
            - "LONG"
            - "LOOK"
            - "LOSE"
            - "LOSS"
            - "LOT"
            - "LOVE"
            - "LOW"
            - "MACHINE"
            - "MAGAZINE"
            - "MAIN"
            - "MAINTAIN"
            - "MAJOR"
            - "MAJORITY"
            - "MAKE"
            - "MAN"
            - "MANAGE"
            - "MANAGEMENT"
            - "MANAGER"
            - "MANY"
            - "MARKET"
            - "MARRIAGE"
            - "MATERIAL"
            - "MATTER"
            - "MAY"
            - "MAYBE"
            - "MEAN"
            - "MEASURE"
            - "MEDIA"
            - "MEDICAL"
            - "MEET"
            - "MEETING"
            - "MEMBER"
            - "MEMORY"
            - "MENTION"
            - "MESSAGE"
            - "METHOD"
            - "MIDDLE"
            - "MIGHT"
            - "MILITARY"
            - "MILLION"
            - "MIND"
            - "MINUTE"
            - "MISS"
            - "MISSION"
            - "MODEL"
            - "MODERN"
            - "MOMENT"
            - "MONEY"
            - "MONTH"
            - "MORE"
            - "MORNING"
            - "MOST"
            - "MOTHER"
            - "MOUTH"
            - "MOVE"
            - "MOVEMENT"
            - "MOVIE"
            - "MRS"
            - "MUCH"
            - "MUSIC"
            - "MUST"
            - "MYSELF"
            - "NAME"
            - "NATION"
            - "NATIONAL"
            - "NATURAL"
            - "NATURE"
            - "NEAR"
            - "NEARLY"
            - "NECESSARY"
            - "NEED"
            - "NETWORK"
            - "NEVER"
            - "NEW"
            - "NEWS"
            - "NEWSPAPER"
            - "NEXT"
            - "NICE"
            - "NIGHT"
            - "NONE"
            - "NOR"
            - "NORTH"
            - "NOT"
            - "NOTE"
            - "NOTHING"
            - "NOTICE"
            - "NOW"
            - "N'T"
            - "NUMBER"
            - "OCCUR"
            - "OFF"
            - "OFFER"
            - "OFFICE"
            - "OFFICER"
            - "OFFICIAL"
            - "OFTEN"
            - "OIL"
            - "OLD"
            - "ONCE"
            - "ONE"
            - "ONLY"
            - "ONTO"
            - "OPEN"
            - "OPERATION"
            - "OPPORTUNITY"
            - "OPTION"
            - "ORDER"
            - "ORGANIZATION"
            - "OTHER"
            - "OTHERS"
            - "OUR"
            - "OUT"
            - "OUTSIDE"
            - "OVER"
            - "OWN"
            - "OWNER"
            - "PAGE"
            - "PAIN"
            - "PAINTING"
            - "PAPER"
            - "PARENT"
            - "PART"
            - "PARTICIPANT"
            - "PARTICULAR"
            - "PARTICULARLY"
            - "PARTNER"
            - "PARTY"
            - "PASS"
            - "PAST"
            - "PATIENT"
            - "PATTERN"
            - "PAY"
            - "PEACE"
            - "PEOPLE"
            - "PER"
            - "PERFORM"
            - "PERFORMANCE"
            - "PERHAPS"
            - "PERIOD"
            - "PERSON"
            - "PERSONAL"
            - "PHONE"
            - "PHYSICAL"
            - "PICK"
            - "PICTURE"
            - "PIECE"
            - "PLACE"
            - "PLAN"
            - "PLANT"
            - "PLAY"
            - "PLAYER"
            - "POINT"
            - "POLICE"
            - "POLICY"
            - "POLITICAL"
            - "POLITICS"
            - "POOR"
            - "POPULAR"
            - "POPULATION"
            - "POSITION"
            - "POSITIVE"
            - "POSSIBLE"
            - "POWER"
            - "PRACTICE"
            - "PREPARE"
            - "PRESENT"
            - "PRESIDENT"
            - "PRESSURE"
            - "PRETTY"
            - "PREVENT"
            - "PRICE"
            - "PRIVATE"
            - "PROBABLY"
            - "PROBLEM"
            - "PROCESS"
            - "PRODUCE"
            - "PRODUCT"
            - "PRODUCTION"
            - "PROFESSIONAL"
            - "PROFESSOR"
            - "PROGRAM"
            - "PROJECT"
            - "PROPERTY"
            - "PROTECT"
            - "PROVE"
            - "PROVIDE"
            - "PUBLIC"
            - "PULL"
            - "PURPOSE"
            - "PUSH"
            - "PUT"
            - "QUALITY"
            - "QUESTION"
            - "QUICKLY"
            - "QUITE"
            - "RACE"
            - "RADIO"
            - "RAISE"
            - "RANGE"
            - "RATE"
            - "RATHER"
            - "REACH"
            - "READ"
            - "READY"
            - "REAL"
            - "REALITY"
            - "REALIZE"
            - "REALLY"
            - "REASON"
            - "RECEIVE"
            - "RECENT"
            - "RECENTLY"
            - "RECOGNIZE"
            - "RECORD"
            - "RED"
            - "REDUCE"
            - "REFLECT"
            - "REGION"
            - "RELATE"
            - "RELATIONSHIP"
            - "RELIGIOUS"
            - "REMAIN"
            - "REMEMBER"
            - "REMOVE"
            - "REPORT"
            - "REPRESENT"
            - "REPUBLICAN"
            - "REQUIRE"
            - "RESEARCH"
            - "RESOURCE"
            - "RESPOND"
            - "RESPONSE"
            - "RESPONSIBILITY"
            - "REST"
            - "RESULT"
            - "RETURN"
            - "REVEAL"
            - "RICH"
            - "RIGHT"
            - "RISE"
            - "RISK"
            - "ROAD"
            - "ROCK"
            - "ROLE"
            - "ROOM"
            - "RULE"
            - "RUN"
            - "SAFE"
            - "SAME"
            - "SAVE"
            - "SAY"
            - "SCENE"
            - "SCHOOL"
            - "SCIENCE"
            - "SCIENTIST"
            - "SCORE"
            - "SEA"
            - "SEASON"
            - "SEAT"
            - "SECOND"
            - "SECTION"
            - "SECURITY"
            - "SEE"
            - "SEEK"
            - "SEEM"
            - "SELL"
            - "SEND"
            - "SENIOR"
            - "SENSE"
            - "SERIES"
            - "SERIOUS"
            - "SERVE"
            - "SERVICE"
            - "SET"
            - "SEVEN"
            - "SEVERAL"
            - "SEX"
            - "SEXUAL"
            - "SHAKE"
            - "SHARE"
            - "SHE"
            - "SHOOT"
            - "SHORT"
            - "SHOT"
            - "SHOULD"
            - "SHOULDER"
            - "SHOW"
            - "SIDE"
            - "SIGN"
            - "SIGNIFICANT"
            - "SIMILAR"
            - "SIMPLE"
            - "SIMPLY"
            - "SINCE"
            - "SING"
            - "SINGLE"
            - "SISTER"
            - "SIT"
            - "SITE"
            - "SITUATION"
            - "SIX"
            - "SIZE"
            - "SKILL"
            - "SKIN"
            - "SMALL"
            - "SMILE"
            - "SOCIAL"
            - "SOCIETY"
            - "SOLDIER"
            - "SOME"
            - "SOMEBODY"
            - "SOMEONE"
            - "SOMETHING"
            - "SOMETIMES"
            - "SON"
            - "SONG"
            - "SOON"
            - "SORT"
            - "SOUND"
            - "SOURCE"
            - "SOUTH"
            - "SOUTHERN"
            - "SPACE"
            - "SPEAK"
            - "SPECIAL"
            - "SPECIFIC"
            - "SPEECH"
            - "SPEND"
            - "SPORT"
            - "SPRING"
            - "STAFF"
            - "STAGE"
            - "STAND"
            - "STANDARD"
            - "STAR"
            - "START"
            - "STATE"
            - "STATEMENT"
            - "STATION"
            - "STAY"
            - "STEP"
            - "STILL"
            - "STOCK"
            - "STOP"
            - "STORE"
            - "STORY"
            - "STRATEGY"
            - "STREET"
            - "STRONG"
            - "STRUCTURE"
            - "STUDENT"
            - "STUDY"
            - "STUFF"
            - "STYLE"
            - "SUBJECT"
            - "SUCCESS"
            - "SUCCESSFUL"
            - "SUCH"
            - "SUDDENLY"
            - "SUFFER"
            - "SUGGEST"
            - "SUMMER"
            - "SUPPORT"
            - "SURE"
            - "SURFACE"
            - "SYSTEM"
            - "TABLE"
            - "TAKE"
            - "TALK"
            - "TASK"
            - "TAX"
            - "TEACH"
            - "TEACHER"
            - "TEAM"
            - "TECHNOLOGY"
            - "TELEVISION"
            - "TELL"
            - "TEN"
            - "TEND"
            - "TERM"
            - "TEST"
            - "THAN"
            - "THANK"
            - "THAT"
            - "THE"
            - "THEIR"
            - "THEM"
            - "THEMSELVES"
            - "THEN"
            - "THEORY"
            - "THERE"
            - "THESE"
            - "THEY"
            - "THING"
            - "THINK"
            - "THIRD"
            - "THIS"
            - "THOSE"
            - "THOUGH"
            - "THOUGHT"
            - "THOUSAND"
            - "THREAT"
            - "THREE"
            - "THROUGH"
            - "THROUGHOUT"
            - "THROW"
            - "THUS"
            - "TIME"
            - "TODAY"
            - "TOGETHER"
            - "TONIGHT"
            - "TOO"
            - "TOP"
            - "TOTAL"
            - "TOUGH"
            - "TOWARD"
            - "TOWN"
            - "TRADE"
            - "TRADITIONAL"
            - "TRAINING"
            - "TRAVEL"
            - "TREAT"
            - "TREATMENT"
            - "TREE"
            - "TRIAL"
            - "TRIP"
            - "TROUBLE"
            - "TRUE"
            - "TRUTH"
            - "TRY"
            - "TURN"
            - "TV"
            - "TWO"
            - "TYPE"
            - "UNDER"
            - "UNDERSTAND"
            - "UNIT"
            - "UNTIL"
            - "UPON"
            - "USE"
            - "USUALLY"
            - "VALUE"
            - "VARIOUS"
            - "VERY"
            - "VICTIM"
            - "VIEW"
            - "VIOLENCE"
            - "VISIT"
            - "VOICE"
            - "VOTE"
            - "WAIT"
            - "WALK"
            - "WALL"
            - "WANT"
            - "WAR"
            - "WATCH"
            - "WATER"
            - "WAY"
            - "WEAPON"
            - "WEAR"
            - "WEEK"
            - "WEIGHT"
            - "WELL"
            - "WEST"
            - "WESTERN"
            - "WHAT"
            - "WHATEVER"
            - "WHEN"
            - "WHERE"
            - "WHETHER"
            - "WHICH"
            - "WHILE"
            - "WHITE"
            - "WHO"
            - "WHOLE"
            - "WHOM"
            - "WHOSE"
            - "WHY"
            - "WIDE"
            - "WIFE"
            - "WILL"
            - "WIN"
            - "WIND"
            - "WINDOW"
            - "WISH"
            - "WITH"
            - "WITHIN"
            - "WITHOUT"
            - "WOMAN"
            - "WONDER"
            - "WORD"
            - "WORK"
            - "WORKER"
            - "WORLD"
            - "WORRY"
            - "WOULD"
            - "WRITE"
            - "WRITER"
            - "WRONG"
            - "YARD"
            - "YEAH"
            - "YEAR"
            - "YES"
            - "YET"
            - "YOU"
            - "YOUNG"
            - "YOUR"
            - "YOURSELF"

  # # This is to analyze and improve my built-in filtering rules
  # - Send:
  #     NewRelic:
  #       APIKey: "${new_relic_license_key}"
  #       CustomEventType: CustomACARSBuiltinOnly

  # Have local Ollama model look only for human-written messages
  # - Filter:
  #     Ollama:
  #       Model: &ollamamodel qwen3:30b-a3b
  #       URL: &ollamaurl http://sophie.home.arpa:11434
  #       FilterOnFailure: true
  #       MaxRetryAttempts: 2
  #       MaxRetryDelaySeconds: 5
  #       Timeout: 30
  #       Options: &ollamaopts [
  #           { Name: num_predict, Value: 150 }, # Maximum number of tokens (words, kinda) to generate
  #           { Name: temperature, Value: 0.4 }, # Creativity (0.0-2.0)
  #           { Name: top_p, Value: 0.2 }, # Answer diversity with top_k (0.0-1.0)
  #           { Name: top_k, Value: 20 }, # Answer diversity (ex 0-100)
  #           { Name: frequency_penalty, Value: 1.1 }, # Penalize repeated tokens (0-2.0)
  #           { Name: num_gpu, Value: 40 }, # Number of layers to offload to GPU
  #         ]
  #       # -----------------------------------------
  #       # 890 characters
  #       # 273 tokens https://token-calculator.net
  #       # -----------------------------------------
  #       UserPrompt: |
  #         IMPORTANT: DISREGARD, IGNORE AND SKIP ANY RAW OR TECHNICAL DATA OR
  #         CODE IN THIS MESSAGE.

  #         This message may feature a human-written message. Human-written
  #         content in these messages might have misspellings, acronyms or
  #         abbreviations similar to cell phone text messages. Human content may
  #         only be a few words.

  #         Forward if the message matches ANY of these criteria:
  #         - It contains communication.
  #         - It contains even a small amount of natural language.
  #         - It contains a complaint, request or command.
  #         - It contains a greeting/sign-offs or their variations, for example:
  #           HI, HELLO, BONJOUR, GOOD MORNING/EVENING,
  #           THANK YOU/THANKS/THNKS/THX, BRGRDS/RGRDS, CHEERS, COPY/COPY THAT.
  #         - Has ANY content after the term FREETEXT or /TXT
  #         - Has /Q/ or QQ or QUESTION MARK.
  #         - Commentary or questions about aircraft passengers,crew,med,medical,
  #           medlink,booking,lavatories (abbreviation: LAV), mechanics
  #           (abbreviation: MX), aircraft seats/rows or other situations or
  #           events relating to air travel.
  #         - Lists a desk number or has DISPATCHER MSG.

  #         Based on these rules, should this message be forwarded?

  # This should be a human message, so send to my private Discord channel, with
  # fancy templating.
  - Send:
      Discord:
        Embed: true
        EmbedColorFacetFields: [ACARSProcessor.From]
        # EmbedColorGradientField: ACARSProcessor.LLMProcessedNumber
        URL: "${acars_discord_webhook}"
        FormatText: true
        FormatTimestamps: true
        # MessageGoTemplate: |
        #   -# From [{{index . "ACARSProcessor.TailCode"}}]({{index . "ACARSProcessor.TrackingLink"}}){{if ne "" (index . "ACARSProcessor.FlightNumber")}} on flight {{index . "ACARSProcessor.FlightNumber"}}{{else}}{{end}} <t:{{index . "ACARSProcessor.UnixTimestamp"}}:R>{{if ne 0.0 (index . "ACARSProcessor.AircraftDistanceMi")}} from {{printf "%.2f" (index . "ACARSProcessor.AircraftDistanceMi")}} miles away{{else}}{{end}}.
        #   ```
        #   {{index . "ACARSProcessor.MessageText"}}
        #   ```
        #   **Links**:
        #   [Translate this message]({{index . "ACARSProcessor.TranslateLink"}})
        #   [ACARSDrama messages from this aircraft]({{index . "ACARSProcessor.ACARSDramaTailNumberLink"}})
        #   [Aircraft Photos]({{index . "ACARSProcessor.PhotosLink"}})
        MessageGoTemplate: >-
          -# From [{{index . "ACARSProcessor.TailCode"}}]({{index .
          "ACARSProcessor.TrackingLink"}}){{if ne "" (index .
          "ACARSProcessor.FlightNumber")}} on flight {{index .
          "ACARSProcessor.FlightNumber"}}{{end}} <t:{{index .
          "ACARSProcessor.UnixTimestamp"}}:R> {{if ne 0.0 (index .
          "ACARSProcessor.AircraftDistanceMi")}} from {{printf "%.2f" (index .
          "ACARSProcessor.AircraftDistanceMi")}} miles away{{end}}.

          ```{{index . "ACARSProcessor.MessageText"}}```

          (Message label {{index . "ACARSProcessor.Label"}})

          **Links**:

          [Translate this message]({{index . "ACARSProcessor.TranslateLink"}})

          [ACARSDrama messages from this aircraft]({{index .
          "ACARSProcessor.ACARSDramaTailNumberLink"}})

          [Aircraft Photos]({{index . "ACARSProcessor.PhotosLink"}})

  # Also send to New Relic as a human message
  - Send:
      NewRelic:
        APIKey: "${new_relic_license_key}"
        CustomEventType: CustomACARSHumanMessages

  # # Use Ollama again to evaluate the emotion of the message and filter in one
  # # step
  # - Annotate:
  #     Ollama:
  #       Model: *ollamamodel
  #       URL: *ollamaurl
  #       MaxRetryAttempts: 2
  #       MaxRetryDelaySeconds: 5
  #       Timeout: 30
  #       Options: *ollamaopts
  #       UserPrompt: |
  #         Rate the prose from found in this message from pilots and ATC between
  #         1-100 for any emotions such as anger, frustration, elation
  #         complaining, gratitude, confusion, etc.

  #         - 1-40 should indicate the message reads as neutral.
  #         - 40-80 should indicate the message is emotional in some way.
  #         - 80-100 should indicate the message is very emotional.

  # - Filter: { Builtin: { LLMProcessedNumberAbove: 40 } }

  # Send emotional messages to a different Discord channel
  # - Send:
  #     Discord:
  #       Embed: true
  #       # EmbedColorFacetFields: [ACARSProcessor.From]
  #       EmbedColorGradientField: ACARSProcessor.LLMProcessedNumber
  #       URL: "${acars_anger_discord_webhook}"
  #       # FormatText: true
  #       # FormatTimestamps: true
  #       MessageGoTemplate: >
  #         {{if eq (index . "ACARSProcessor.From") "Aircraft"}}From{{else}}To
  #         {{end}} [{{index . "ACARSProcessor.TailCode"}}]({{index .
  #         "ACARSProcessor.TrackingLink"}}) {{if ne "" (index .
  #         "ACARSProcessor.FlightNumber")}} on flight  {{index .
  #         "ACARSProcessor.FlightNumber"}}{{else}}{{end}} <t:{{index .
  #         "ACARSProcessor.UnixTimestamp"}}:R> {{if ne 0.0 (index .
  #         "ACARSProcessor.AircraftDistanceMi")}} from  {{printf "%.2f" (index .
  #         "ACARSProcessor.AircraftDistanceMi")}} miles away{{else}}{{end}}.

  #         -# This message rated a {{index .
  #         "ACARSProcessor.LLMProcessedNumber"}} in terms of emotional content.

  #         ``` {{index . "ACARSProcessor.MessageText"}} ```

  #         The LLM had this to say:

  #         ``` {{index . "ACARSProcessor.LLMModelFeedbackText"}} ```

  #         **Links**:

  #         [Translate this message]({{index . "ACARSProcessor.TranslateLink"}})

  #         [ACARSDrama messages from this aircraft]({{index .
  #         "ACARSProcessor.ACARSDramaTailNumberLink"}})

  #         [Aircraft Photos]({{index . "ACARSProcessor.PhotosLink"}})
